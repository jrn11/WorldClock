<!DOCTYPE html>
<html lang=\"en\">
<head>
  <meta charset=\"UTF-8\">
  <meta http-equiv=\"refresh\" content=\"300\">
  <title>World Clock</title>
  <style>
    html, body {
      background-color: #0b0f19;
      color: #e0e6f0;
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .clock-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px;
      width: 90%;
      max-width: 1400px;
    }

    .clock {
      background-color: #1b2436;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.6);
    }

    .zone-label {
      font-size: 1.4rem;
      opacity: 0.8;
      margin-bottom: 8px;
    }

    .time-display {
      font-size: 2.8rem;
      font-weight: bold;
    }

    #date-display {
      font-size: 2.2rem;
      margin-bottom: 0.8em;
      padding: 12px 20px;
      background-color: #14203a;
      border-radius: 10px;
      letter-spacing: 4px;
      opacity: 0.9;
      box-shadow: 0 4px 12px rgba(0,0,0,0.7);
    }
  </style>
</head>
<body>
  <div id=\"date-display\"></div>
  <div class=\"clock-grid\" id=\"clocks\"></div>

<script>
const timezones = [
  { label: "Zulu (UTC)", tz: "Etc/UTC" },
  { label: "Pacific", tz: "America/Los_Angeles" },
  { label: "Mountain", tz: "America/Denver" },
  { label: "Central", tz: "America/Chicago" },
  { label: "Eastern", tz: "America/New_York" },
  { label: "Atlantic", tz: "America/Halifax" }
];

function createClockElements() {
  document.getElementById("clocks").innerHTML = timezones.map(zone => `
    <div class="clock">
      <div class="zone-label">${zone.label}</div>
      <div class="time-display" id="${zone.tz.replace(/\//g, '_')}">Loading...</div>
    </div>
  `).join('');
}

async function fetchWithRetries(url, retries = 3) {
  for (let attempt = 0; attempt < retries; attempt++) {
    try {
      const res = await fetch(url, {cache: 'no-cache'});
      if (res.ok) return await res.json();
    } catch (e) {
      if (attempt === retries - 1) throw e;
    }
  }
  throw new Error('Max retries exceeded');
}

async function fetchOffsets() {
  const offsets = {};
  await Promise.all(timezones.map(async zone => {
    try {
      const data = await fetchWithRetries(`https://worldtimeapi.org/api/timezone/${zone.tz}`);
      offsets[zone.tz] = data.utc_offset;
    } catch (error) {
      console.error(`Error fetching offset for ${zone.tz}:`, error);
      offsets[zone.tz] = null;
    }
  }));
  return offsets;
}

function updateClocks(offsets) {
  const now = new Date();
  timezones.forEach(zone => {
    const el = document.getElementById(zone.tz.replace(/\//g, '_'));
    const offset = offsets[zone.tz];
    if (!offset) {
      el.textContent = "--:--:--";
      return;
    }
    const [sign, hh, mm] = offset.match(/([+-])(\d{2}):(\d{2})/).slice(1);
    const offsetMinutes = parseInt(hh) * 60 + parseInt(mm);
    const utc = now.getTime() + now.getTimezoneOffset() * 60000;
    const tzTime = new Date(utc + (sign === '+' ? 1 : -1) * offsetMinutes * 60000);
    el.textContent = tzTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
  });

  const dateStr = now.toLocaleDateString(undefined, { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });
  document.getElementById('date-display').textContent = dateStr.replace(/,/g, ' Â·');
}

async function init() {
  createClockElements();
  const offsets = await fetchOffsets();
  updateClocks(offsets);
  setInterval(() => updateClocks(offsets), 1000);
}

init();
</script>
</body>
</html>
